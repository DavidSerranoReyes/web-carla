---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header';
import Footer from '../components/Footer';
import FilmCard from '../components/FilmCard';
import ArticleCard from '../components/ArticleCard';
import CriticismCard from '../components/CriticismCard';
import '../styles/PortfolioCards.css';

const base = import.meta.env.BASE_URL;
---

<Layout
  title="Portfolio - Carla Larrea Sánchez"
  description="Explora el portfolio de Carla Larrea: films premiados internacionalmente, artículos académicos sobre cine y derechos humanos, y crítica cinematográfica."
>
  <div transition:persist="header">
    <Header client:load />
  </div>

  <main class="portfolio-main" transition:animate="slide">
    <div class="container">
      <h1 class="page-title fade-in">Portfolio</h1>

      <section class="portfolio-section fade-in">
        <h2 class="section-title" data-es="Films" data-en="Films">Films</h2>

        <FilmCard
          client:idle
          title="INDELEBLE"
          titleEn="INDELIBLE"
          year="2016"
          duration="11:46 min"
          country="México"
          posterImage={`${base}images/films/indeleble.jpg`}
          galleryImages={[
            `${base}images/films/indeleble1.jpg`,
            `${base}images/films/indeleble2.jpg`,
            `${base}images/films/indeleble3.jpg`,
          ]}
          synopsis="Una noche antes de irse a estudiar al extranjero, José sale de fiesta con Milena, su mejor amiga. Después de un coqueteo mutuo, finalmente, Milena rechaza a José. Al concluir la noche, sucederá algo que cambiará su relación y a ellos, para siempre."
          synopsisEn="The night before leaving to study abroad, José goes out partying with Milena, his best friend. After mutual flirting, Milena finally rejects José. At the end of the night, something will happen that will change their relationship and them, forever."
          director="Carla Larrea Sánchez"
          festivals={[
            'Festival Internacional de Cine de Morelia 2016 - Selección oficial',
            'Festival Pantalla de Cristal 2016 - Premio "Mejor Banda Sonora"',
            'CECEACHERO FILM FEST 2017 - Premio del público',
            'CHOUFTOUHONNA, Tunis International Feminist Art Festival 2017 - Premio "Coup de coeur"',
            'Festival Internacional de Cine de Quito 2017',
          ]}
          festivalsEn={[
            'Morelia International Film Festival 2016 - Official Selection',
            'Pantalla de Cristal Festival 2016 - "Best Soundtrack" Award',
            'CECEACHERO FILM FEST 2017 - Audience Award',
            'CHOUFTOUHONNA, Tunis International Feminist Art Festival 2017 - "Coup de coeur" Award',
            'Quito International Film Festival 2017',
          ]}
          pdfUrl={`${base}films/indeleble-ficha.pdf`}
          trailerUrl="https://www.youtube.com/watch?v=rEprGd9fESk"
          fullFilmUrl="https://vimeo.com/176618936"
        />

        <FilmCard
          client:idle
          title="POR MAGDA"
          titleEn="FOR MAGDA"
          year="2019"
          duration="19:20 min"
          country="Ecuador"
          posterImage={`${base}images/films/pormagda.jpg`}
          galleryImages={[`${base}images/films/pormagda1.jpg`, `${base}images/films/pormagda2.jpg`]}
          synopsis="Lía, una profesora de 35 años, parece llevar una vida estable junto a Santiago, su compañero desde hace años, y sus dos mejores amigas, Eva y Lola. Sin embargo, su mundo se desmorona cuando descubre que Santiago mantiene una relación secreta con su prima Gabriela. Al mismo tiempo, un diagnóstico médico inesperado —cáncer de cuello uterino avanzado— la enfrenta a una cirugía radical que cambiará su cuerpo y su vida para siempre. Mientras Lola lidia con las secuelas de un aborto y Eva explora una relación atípica, las tres amigas se verán forzadas a confrontar mentiras, secretos y la fragilidad de sus propios vínculos. El Secreto de Lía es una historia íntima y conmovedora sobre la traición, la sororidad, la salud femenina y el coraje de reconstruirse cuando todo parece desmoronarse."
          synopsisEn="Lía, a 35-year-old teacher, seems to lead a stable life with Santiago, her partner of many years, and her two best friends, Eva and Lola. However, her world crumbles when she discovers that Santiago is secretly involved with her cousin Gabriela. At the same time, an unexpected medical diagnosis—advanced cervical cancer—forces her to face radical surgery that will change her body and her life forever. While Lola deals with the aftermath of an abortion and Eva explores an unconventional relationship, the three friends are forced to confront lies, secrets, and the fragility of their own bonds. Lía's Secret is an intimate and moving story about betrayal, sisterhood, women's health, and the courage to rebuild when everything seems to fall apart."
          director="Carla Larrea Sánchez"
          festivals={[
            'Festival Internacional de Cine de Mar del Plata 2019 - Competencia Internacional',
            'Festival Internacional de Cine de Guadalajara 2020 - Selección oficial',
            'Festival Internacional de Cine de Morelia 2019 - Selección oficial',
            'BAFICI - Buenos Aires Festival Internacional de Cine Independiente 2020',
            'Festival de Cine de Lima 2019',
            'Festival Internacional de Cortometrajes de São Paulo 2020',
          ]}
          festivalsEn={[
            'Mar del Plata International Film Festival 2019 - International Competition',
            'Guadalajara International Film Festival 2020 - Official Selection',
            'Morelia International Film Festival 2019 - Official Selection',
            'BAFICI - Buenos Aires International Independent Film Festival 2020',
            'Lima Film Festival 2019',
            'São Paulo International Short Film Festival 2020',
          ]}
          pdfUrl={`${base}films/PORMAGDA2.pdf`}
          trailerUrl="https://www.youtube.com/watch?v=OP45hzcx9R8"
          fullFilmUrl="https://vimeo.com/657537728"
        />
      </section>

      <section class="portfolio-section fade-in">
        <h2 class="section-title" data-es="Artículos Académicos" data-en="Academic Articles">
          Artículos Académicos
        </h2>
        <div class="portfolio-grid">
          <!-- EJEMPLO - Reemplaza con tus artículos reales -->
          <!-- Copia este bloque ArticleCard y modifica los datos según CONTENIDO_PORTFOLIO.md -->
          <ArticleCard
            client:load
            title="Título de ejemplo de artículo académico"
            titleEn="Example academic article title"
            journal="Revista Académica Ejemplo"
            journalEn="Example Academic Journal"
            year="2024"
            authors={['Carla Larrea Sánchez']}
            abstract="Este es un resumen de ejemplo de un artículo académico. Aquí describirías brevemente el contenido, metodología y principales hallazgos de tu investigación. Reemplaza este texto con el resumen real de tu artículo."
            abstractEn="This is an example abstract of an academic article. Here you would briefly describe the content, methodology and main findings of your research. Replace this text with the actual abstract of your article."
            keywords={['cine', 'derechos humanos', 'género', 'feminismo']}
            keywordsEn={['cinema', 'human rights', 'gender', 'feminism']}
            pdfUrl={`${base}articles/articulo-ejemplo.pdf`}
            externalUrl="https://example.com/article"
          />

          <!-- Agrega más artículos aquí copiando el bloque ArticleCard -->

          <!-- Mensaje temporal si no hay artículos -->
          <div class="coming-soon-card">
            <p data-es="Próximamente se agregarán más artículos académicos">
              Próximamente se agregarán más artículos académicos
            </p>
            <p data-en="More academic articles coming soon" style="display: none;">
              More academic articles coming soon
            </p>
          </div>
        </div>
      </section>

      <section class="portfolio-section fade-in">
        <h2 class="section-title" data-es="Crítica Cinematográfica" data-en="Film Criticism">
          Crítica Cinematográfica
        </h2>
        <div class="portfolio-grid">
          <!-- EJEMPLO - Reemplaza con tus críticas reales -->
          <!-- Copia este bloque CriticismCard y modifica los datos según CONTENIDO_PORTFOLIO.md -->
          <CriticismCard
            client:load
            title="Título de ejemplo de crítica"
            titleEn="Example review title"
            filmTitle="Nombre de la Película"
            filmTitleEn="Film Name"
            publication="Medio de Publicación"
            publicationEn="Publication Medium"
            date="15 de marzo, 2024"
            excerpt="Este es un extracto de ejemplo de una crítica cinematográfica. Aquí escribirías las primeras líneas de tu análisis fílmico. Reemplaza este texto con el extracto real de tu crítica."
            excerptEn="This is an example excerpt of a film review. Here you would write the first lines of your film analysis. Replace this text with the actual excerpt of your review."
            url="https://example.com/review"
          />

          <!-- Agrega más críticas aquí copiando el bloque CriticismCard -->

          <!-- Mensaje temporal si no hay críticas -->
          <div class="coming-soon-card">
            <p data-es="Próximamente se agregarán más críticas cinematográficas">
              Próximamente se agregarán más críticas cinematográficas
            </p>
            <p data-en="More film reviews coming soon" style="display: none;">
              More film reviews coming soon
            </p>
          </div>
        </div>
      </section>
    </div>
  </main>

  <div transition:persist="footer">
    <Footer />
  </div>
</Layout>

<style>
  .portfolio-main {
    min-height: 100vh;
    padding-top: 120px;
    padding-bottom: var(--spacing-xl);
  }

  .page-title {
    text-align: center;
    margin-bottom: var(--spacing-lg);
  }

  .portfolio-section {
    margin-bottom: var(--spacing-xl);
  }

  .portfolio-section h2 {
    margin-bottom: var(--spacing-md);
    border-bottom: 2px solid var(--color-accent);
    padding-bottom: var(--spacing-sm);
  }

  .portfolio-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--spacing-md);
  }

  .coming-soon-card {
    padding: var(--spacing-xl);
    border: 2px dashed var(--color-border);
    border-radius: var(--radius-md);
    text-align: center;
    color: var(--color-text-secondary);
    font-style: italic;
    min-height: 200px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .coming-soon-card p {
    margin: 0;
  }

  .portfolio-card {
    padding: var(--spacing-md);
    border: 2px solid var(--color-border);
    border-radius: var(--radius-md);
    transition: all var(--transition-normal);
  }

  .portfolio-card:hover {
    border-color: var(--color-accent);
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  }

  .portfolio-card h3 {
    margin-bottom: var(--spacing-sm);
  }

  /* FilmCard Styles */
  :global(.film-card) {
    background: var(--color-card-bg);
    border: 2px solid var(--color-border);
    border-radius: var(--radius-lg);
    overflow: hidden;
    margin-bottom: var(--spacing-xl);
    transition: all var(--transition-normal);
  }

  :global(.film-card:hover) {
    border-color: var(--color-accent);
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  }

  /* Poster principal más grande y prominente */
  :global(.film-poster-large) {
    position: relative;
    width: 100%;
    height: 1300px;
    overflow: hidden;
  }

  :global(.film-poster-large img) {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition-slow);
  }

  :global(.film-card:hover .film-poster-large img) {
    transform: scale(1.03);
  }

  :global(.film-overlay) {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(
      to top,
      rgba(0, 0, 0, 0.95) 0%,
      rgba(0, 0, 0, 0.85) 40%,
      rgba(0, 0, 0, 0.6) 70%,
      transparent 100%
    );
    padding: var(--spacing-xl);
    color: white;
  }

  :global(.film-title) {
    font-size: 3rem;
    margin-bottom: var(--spacing-xs);
    font-weight: bold;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
  }

  :global(.film-meta) {
    font-size: 1.2rem;
    opacity: 0.95;
    margin-bottom: var(--spacing-xs);
  }

  :global(.film-director) {
    font-size: 1.1rem;
    opacity: 0.9;
    font-style: italic;
  }

  /* Ensure meta/director text stays visible on top of poster overlay in all themes */
  :global(.film-meta),
  :global(.film-director) {
    color: #e6eef8 !important; /* light bluish to match dark mode */
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.6);
  }

  :global(.film-content) {
    padding: var(--spacing-xl);
    max-width: 1200px;
    margin: 0 auto;
  }

  /* Galería de imágenes más compacta */
  :global(.film-gallery) {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-xl);
  }

  :global(.film-gallery img) {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-radius: var(--radius-sm);
    transition: all var(--transition-normal);
    cursor: pointer;
  }

  :global(.film-gallery img:hover) {
    transform: scale(1.05);
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
  }

  /* Contenido centrado y bien espaciado */
  :global(.film-info-center) {
    max-width: 900px;
    margin: 0 auto;
  }

  :global(.film-section) {
    margin-bottom: var(--spacing-xl);
    text-align: center;
  }

  :global(.film-section h3) {
    font-size: 1.8rem;
    margin-bottom: var(--spacing-md);
    color: var(--color-accent);
    text-transform: uppercase;
    letter-spacing: 2px;
  }

  :global(.film-synopsis) {
    line-height: 1.9;
    text-align: justify;
    font-size: 1.1rem;
    padding: 0 var(--spacing-md);
  }

  :global(.film-festivals) {
    list-style: none;
    padding: 0;
    text-align: left;
    display: inline-block;
  }

  :global(.film-festivals li) {
    padding: var(--spacing-sm) var(--spacing-md);
    position: relative;
    padding-left: 2rem;
    margin-bottom: var(--spacing-xs);
    line-height: 1.6;
  }

  :global(.film-festivals li::before) {
    content: '★';
    position: absolute;
    left: 0.25rem;
    color: var(--color-accent);
    font-size: 1.3rem;
  }

  /* Trailer en miniatura */
  :global(.trailer-thumbnail) {
    position: relative;
    cursor: pointer;
    border-radius: var(--radius-md);
    overflow: hidden;
    max-width: 600px;
    margin: 0 auto;
    transition: all var(--transition-normal);
  }

  :global(.trailer-thumbnail:hover) {
    transform: scale(1.02);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  }

  :global(.trailer-thumbnail img) {
    width: 100%;
    height: auto;
    display: block;
  }

  :global(.play-button) {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    transition: all var(--transition-normal);
  }

  :global(.trailer-thumbnail:hover .play-button) {
    transform: translate(-50%, -50%) scale(1.1);
  }

  :global(.trailer-embed) {
    position: relative;
    padding-bottom: 56.25%;
    height: 0;
    overflow: hidden;
    max-width: 800px;
    margin: 0 auto;
    border-radius: var(--radius-md);
  }

  :global(.trailer-embed iframe) {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: var(--radius-md);
  }

  /* Botones de acción más compactos */
  :global(.film-actions) {
    display: flex;
    gap: var(--spacing-md);
    justify-content: center;
    flex-wrap: wrap;
    margin-top: var(--spacing-xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
  }

  :global(.btn-action) {
    padding: var(--spacing-sm) var(--spacing-lg);
    border: 2px solid var(--color-accent);
    background: transparent;
    color: var(--color-text);
    border-radius: var(--radius-full);
    font-family: var(--font-main);
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-normal);
    text-transform: uppercase;
    letter-spacing: 1px;
    min-width: 200px;
  }

  :global(.btn-action:hover) {
    background: var(--color-accent);
    color: var(--color-bg);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(255, 255, 255, 0.2);
  }

  :global(.btn-action:active) {
    transform: translateY(0);
  }

  @media (max-width: 768px) {
    .portfolio-main {
      padding-top: 100px;
    }

    .portfolio-grid {
      grid-template-columns: 1fr;
    }

    :global(.film-poster-large) {
      height: 600px;
    }

    :global(.film-title) {
      font-size: 2rem;
    }

    :global(.film-meta),
    :global(.film-director) {
      font-size: 0.95rem;
    }

    :global(.film-content) {
      padding: var(--spacing-md);
    }

    :global(.film-section h3) {
      font-size: 1.4rem;
    }

    :global(.film-synopsis) {
      font-size: 1rem;
      padding: 0;
    }

    :global(.film-gallery) {
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: var(--spacing-sm);
    }

    :global(.film-gallery img) {
      height: 120px;
    }

    :global(.film-actions) {
      flex-direction: column;
      gap: var(--spacing-sm);
    }

    :global(.btn-action) {
      min-width: 100%;
      font-size: 0.9rem;
    }

    :global(.trailer-thumbnail),
    :global(.trailer-embed) {
      max-width: 100%;
    }

    /* React components should NOT have scroll animations (causes hydration issues) */
    :global(.film-card) {
      opacity: 1;
      animation: fadeInUp 0.6s ease forwards;
    }

    /* Scroll animations only for static Astro elements */
    .portfolio-section {
      opacity: 0;
      transform: translateY(30px);
      transition:
        opacity 0.6s ease,
        transform 0.6s ease;
    }

    .portfolio-section.animate-in {
      opacity: 1;
      transform: translateY(0);
    }

    /* Simple fade-in keyframe for React components */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  }
</style>

<script>
  function updateLanguage() {
    const currentLang = localStorage.getItem('language') || 'es';

    // Update section titles
    document.querySelectorAll('[data-es][data-en]').forEach((element) => {
      const htmlElement = element as HTMLElement;
      if (currentLang === 'en') {
        htmlElement.textContent = htmlElement.getAttribute('data-en') || '';
      } else {
        htmlElement.textContent = htmlElement.getAttribute('data-es') || '';
      }
    });
  }

  // Scroll animations for mobile
  function initScrollAnimations() {
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px',
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate-in');
        }
      });
    }, observerOptions);

    // Observe only static Astro elements, NOT React components
    document.querySelectorAll('.portfolio-section').forEach((el) => {
      observer.observe(el);
    });
  }

  // Update on page load
  updateLanguage();
  initScrollAnimations();

  // Update when language changes
  window.addEventListener('storage', (e) => {
    if (e.key === 'language') {
      updateLanguage();
    }
  });

  // Update after View Transitions
  document.addEventListener('astro:after-swap', () => {
    updateLanguage();
    initScrollAnimations();
  });
</script>
